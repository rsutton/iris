version: 2
jobs:
  build:
    docker:
    - image: docker:17.05.0-ce-git
    steps:
      - checkout
      - setup_remote_docker
      # build the application image
      - run: docker build -t rsutton/iris:$CIRCLE_BRANCH .
      # save the image
      # - run: docker push rsutton/iris:$CIRCLE_BRANCH
      # run the app
      - run: 
          name: "Smoke Test"
          command: docker run -d --name iris -p 8000:8000 rsutton/iris:$CIRCLE_BRANCH
